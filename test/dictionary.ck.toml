sets = [
  {name = "wikistat", type = "clickhouse", description = "", root = "wikistat", join = [
    {data_source1 = "wikistat", data_source2 = "wikistat_relate", join_on = [
      {dimension1 = "project", dimension2 = "project"},
    ]},
    {data_source1 = "wikistat_relate", data_source2 = "wikistat_class", join_on = [
      {dimension1 = "class_id", dimension2 = "class_id"},
    ]},
  ]},
]

sources = [
  {database = "", name = "wikistat", alias = "", description = ""},
  {database = "",name = "wikistat_relate", alias = "", description = ""},
  {database = "",name = "wikistat_class", alias = "", description = ""},
]

metrics = [
  {data_source = "wikistat", type = "METRIC_SUM", name = "hits", field_name = "hits", value_type = "VALUE_INTEGER", description = ""},
  {data_source = "wikistat", type = "METRIC_SUM", name = "size_sum", field_name = "size", value_type = "VALUE_INTEGER", description = ""},
  {data_source = "wikistat", type = "METRIC_COUNT", name = "count", field_name = "*", value_type = "VALUE_INTEGER", description = ""},
  {data_source = "wikistat", type = "METRIC_DIVIDE", name = "hits_avg", field_name = "", value_type = "VALUE_FLOAT", composition = ["wikistat.hits", "wikistat.count"], description = ""},
  {data_source = "wikistat", type = "METRIC_DIVIDE", name = "size_avg", field_name = "", value_type = "VALUE_FLOAT", composition = ["wikistat.size_sum", "wikistat.count"], description = ""},
  {data_source = "wikistat", type = "METRIC_DIVIDE", name = "hits_per_size", field_name = "", value_type = "VALUE_FLOAT", composition = ["wikistat.hits", "wikistat.size_sum"], description = ""},
  {data_source = "wikistat", type = "METRIC_DISTINCT_COUNT", name = "project_count", field_name = "project", value_type = "VALUE_INTEGER", description = "", filter = {operator_type = "FILTER_OPERATOR_GREATER_EQUALS", value_type = "VALUE_INTEGER", name = "hits", value = [1]}},
  {data_source = "wikistat", type = "METRIC_SUM", name = "hits_sum", field_name = "hits", value_type = "VALUE_INTEGER", description = "", filter = {operator_type = "FILTER_OPERATOR_GREATER_EQUALS", value_type = "VALUE_INTEGER", name = "hits", value = [1]}},
  {data_source = "wikistat_relate", type = "METRIC_SUM", name = "source_sum", field_name = "source", value_type = "VALUE_FLOAT", description = ""},
  {data_source = "wikistat_relate", type = "METRIC_COUNT", name = "count", field_name = "*", value_type = "VALUE_INTEGER", description = ""},
  {data_source = "wikistat_relate", type = "METRIC_DIVIDE", name = "source_avg", field_name = "", value_type = "VALUE_FLOAT", composition = ["wikistat_relate.source_sum", "wikistat_relate.count"], description = ""},
]

dimensions = [
  {data_source = "wikistat", name = "date", field_name = "date", value_type = "VALUE_STRING", description = ""},
  {data_source = "wikistat", name = "time_by_hour", field_name = "formatDateTime(time, '%Y-%m-%d %H:00:00')", value_type = "VALUE_STRING", description = ""},
  {data_source = "wikistat", name = "project", field_name = "project", value_type = "VALUE_STRING", description = ""},
  {data_source = "wikistat", name = "sub_project", field_name = "subproject", value_type = "VALUE_STRING", description = ""},
  {data_source = "wikistat", name = "path", field_name = "path", value_type = "VALUE_STRING", description = ""},
  {data_source = "wikistat_relate", name = "project", field_name = "project", value_type = "VALUE_STRING", description = ""},
  {data_source = "wikistat_relate", name = "class_id", field_name = "class", value_type = "VALUE_INTEGER", description = ""},
  {data_source = "wikistat_class", name = "class_id", field_name = "id", value_type = "VALUE_INTEGER", description = ""},
  {data_source = "wikistat_class", name = "class_name", field_name = "name", value_type = "VALUE_STRING", description = ""},
]
